extends layout

block content
  h1= title
  form(id='sculptureForm', action=`/sculptures/${toShow._id}`, method='POST')
    input(type='hidden', name='_method', value='PUT')
    div.form-group
      label(for='sculpture_name') Sculpture Name:
      input#sculpture_name(type='text', name='sculpture_name', value=toShow.sculpture_name, required=true)

    div.form-group
      label(for='sculpture_material') Material:
      input#sculpture_material(type='text', name='sculpture_material', value=toShow.sculpture_material, required=true)

    div.form-group
      label(for='sculpture_height') Height (in cm):
      input#sculpture_height(type='number', name='sculpture_height', value=toShow.sculpture_height, min='1', required=true)

    input.btn.btn-primary(type='submit', value='Update')

block script
  script.
    document.forms['sculptureForm'].addEventListener('submit', async (event) => {
      event.preventDefault();
      const formData = new FormData(event.target);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch(event.target.action, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data),
        });

        if (!response.ok) {
          const errorText = await response.text();
          throw new Error(errorText || 'Unknown error occurred');
        }

        alert('Update succeeded');
        window.location.href = "/"; // Redirect to homepage or appropriate page
      } catch (error) {
        console.error('Update failed:', error.message);
        alert('Update failed: ' + error.message);
      }
    });
